<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Day7 ë‹¨ì–´ì¥ í€´ì¦ˆ</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    h1, h2 { text-align: center; }
    #controls { display: flex; gap: 10px; justify-content: center; align-items: center; margin-bottom: 20px; flex-wrap: wrap; }
    button { padding: 12px 24px; margin: 4px; cursor: pointer; border: none; border-radius: 4px; font-size: 16px; }
    #scoreboard { font-weight: bold; margin-left: 20px; }
    #checklist { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; min-height: 50px; }
    #checklist .item { padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    input[type="text"] { width: calc(100% - 16px); padding: 8px; margin-bottom: 10px; box-sizing: border-box; font-size: 16px; }
    .btn-start { background: #007bff; color: white; }
    .btn-submit { background: #28a745; color: white; }
    .btn-stop { background: #dc3545; color: white; }
    .btn-retry { background: #ffc107; color: #212529; }
    .btn-restart { background: #17a2b8; color: white; }
    .btn-shuffle { background: #6c757d; color: white; }
  </style>
</head>
<body>
  <h1>Day7 ë‹¨ì–´ì¥ í€´ì¦ˆ</h1>
  <div id="controls"></div>
  <div id="checklist"></div>
  <div id="app"></div>

  <script>
      const originalList = [
        { korean: "êµí†µ í‘œì§€íŒ", english: "Traffic Signs" },
        { korean: "ì •ì§€", english: "a stop" },
        { korean: "ì§„ì… ê¸ˆì§€", english: "do not enter" },
        { korean: "ì¼ë°© í†µí–‰", english: "one way" },
        { korean: "ì œí•œ ì†ë„", english: "a speed limit" },
        { korean: "Uí„´ í—ˆìš©", english: "U-turn OK" },
        { korean: "ì¶œêµ¬ ì—†ìŒ / ë§‰ë‹¤ë¥¸ ê¸¸", english: "no outlet / dead end" },
        { korean: "ìš°íšŒì „ë§Œ í—ˆìš©", english: "right turn only" },
        { korean: "ì¢ŒíšŒì „ ê¸ˆì§€", english: "no left turn" },
        { korean: "ì–‘ë³´", english: "yield" },
        { korean: "í•©ë¥˜ ì°¨ì„ ", english: "a merge" },
        { korean: "ì£¼ì°¨ ê¸ˆì§€", english: "no parking" },
        { korean: "ì¥ì• ì¸ ì£¼ì°¨ì¥", english: "handicapped parking" },
        { korean: "íš¡ë‹¨ ë³´ë„", english: "a pedestrian crossing" },
        { korean: "ì² ë„ ê±´ë„ëª©", english: "a railroad crossing" },
        { korean: "í•™êµ íš¡ë‹¨ë³´ë„", english: "a school crossing" },
        { korean: "ë„ë¡œ ê³µì‚¬", english: "roadwork" },
        { korean: "êµ­ë„ / ê³ ì†ë„ë¡œ í‘œì§€íŒ", english: "a U.S. route / a highway marker" },
        { korean: "ë³‘ì›", english: "a hospital" },
    
        { korean: "ë°©í–¥", english: "Directions" },
        { korean: "Elm St.ì—ì„œ ì§ì§„í•˜ë‹¤", english: "go straight on Elm Street" },
        { korean: "Pine St.ì—ì„œ ìš°íšŒì „í•˜ë‹¤", english: "turn right on Pine Street" },
        { korean: "Oak St.ì—ì„œ ì¢ŒíšŒì „í•˜ë‹¤", english: "turn left on Oak Street" },
        { korean: "ëª¨í‰ì´ì—ì„œ ì •ì§€í•˜ë‹¤", english: "stop at the corner" },
        { korean: "Main St.ë¥¼ ì§€ë‚˜ë‹¤", english: "go past Main Street" },
        { korean: "First St.ìœ¼ë¡œ í•œ ë¸”ë¡ ê°€ë‹¤", english: "go one block to First Street" },
    
        { korean: "ì§€ë„", english: "Maps" },
        { korean: "ë¶", english: "north" },
        { korean: "ì„œ", english: "west" },
        { korean: "ë‚¨", english: "south" },
        { korean: "ë™", english: "east" },
        { korean: "ê¸°í˜¸", english: "a symbol" },
        { korean: "ë²”ë¡€", english: "a key" },
        { korean: "ì¶•ì²™", english: "a scale" },
        { korean: "ê±°ë¦¬", english: "a street" },
        { korean: "ê³ ì†ë„ë¡œ", english: "a highway" },
        { korean: "ê°•", english: "a river" },
        { korean: "ê¸€ë¡œë²Œ ìœ„ì¹˜ í™•ì¸ ì‹œìŠ¤í…œ", english: "GPS (global positioning system)" },
        { korean: "ì¸í„°ë„· ì§€ë„", english: "Internet map" },
    
        { korean: "ì†Œìš¸ ë©”ì´íŠ¸, ë‚˜ì˜ ì¸ì—°", english: "the one" },
        { korean: "ì—°ì„¤", english: "public speaking" },
        { korean: "ëˆˆë¬¼ì´ í„°ì§€ë‹¤", english: "burst into tears" },
        { korean: "ê¸°ì ˆí•˜ë‹¤", english: "faint" },
        { korean: "í˜ë“¤ê³  ê¸´ í•˜ë£¨ë‹¤", english: "have a long day" },
        { korean: "ë§ˆìŒì€ (ì†ë‚´ëŠ”, ë‚´ë©´ìœ¼ë¡œëŠ”)", english: "on the inside" },
        { korean: "(ê·¹ì¥ ë“±) ê°€ì¥ ì¢‹ì€ ìë¦¬ë¥¼ ë§¡ë‹¤", english: "get the best seat in the house" },
        { korean: "ì‚¬ì´ê°€ ì•ˆ ì¢‹ë‹¤", english: "be on bad terms" },
        { korean: "íŒë§¤ê°€ ì‹œì‘ë˜ë‹¤", english: "go on sale" },
        { korean: "ì•„ë‚Œì—†ì´ (~ë¥¼) í•˜ë‹¤", english: "go all out (~ing)" },
        { korean: "ì ê¹ ë‚˜ê°€ë‹¤", english: "step out for a second" },
        { korean: "ë¶„ìœ„ê¸°", english: "vibe" },
        { korean: "ë»—ë‹¤, ë»—ì–´ ë²„ë¦¬ë‹¤", english: "be out cold" },
        { korean: "ë„¤ ì–¼êµ´ì— ë‹¤ ì¨ì ¸ìˆì–´.", english: "It's written all over your face." },
        { korean: "ëª‡ ë…„ì˜ ì—°ìŠµì´ì§€.", english: "Years of practice." }
      ];
    let baseList = [...originalList];
    let quizList = [...baseList];
    let history = [];
    let correctCount = 0, wrongCount = 0;
    let stage = 'initial';
    let shuffleEnabled = false;

    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }
    function normalize(str) {
      return str
        .replace(/[^a-z]/gi, '')  // Aâ€“Z, aâ€“z ì´ì™¸ëŠ” ë‹¤ ì œê±°
        .toLowerCase();
    }
    function toggleShuffle() {
      shuffleEnabled = !shuffleEnabled;
      rebuildQuizList();
      render();
    }

    function rebuildQuizList() {
      const done = history.map(h => ({ korean: h.korean, english: h.english }));
      const doneSet = new Set(done.map(d => d.korean));
      let remaining = baseList.filter(item => !doneSet.has(item.korean));
      if (shuffleEnabled) remaining = shuffleArray([...remaining]);
      quizList = [...done, ...remaining];
    }

    function renderControls() {
      const ctrl = document.getElementById('controls');
      ctrl.innerHTML = '';
      if (stage === 'initial') {
        const shuffleBtn = document.createElement('button');
        shuffleBtn.textContent = shuffleEnabled ? 'Shuffle: ON' : 'Shuffle: OFF';
        shuffleBtn.className = 'btn-shuffle';
        shuffleBtn.onclick = toggleShuffle;
        ctrl.appendChild(shuffleBtn);
        const startBtn = document.createElement('button');
        startBtn.textContent = 'Start Quiz';
        startBtn.className = 'btn-start';
        startBtn.onclick = () => { stage = 'quiz'; rebuildQuizList(); render(); };
        ctrl.appendChild(startBtn);
      }
      if (stage === 'quiz') {
        const stopBtn = document.createElement('button');
        stopBtn.textContent = 'Stop Quiz'; stopBtn.className = 'btn-stop'; stopBtn.onclick = () => { stage = 'initial'; render(); };
        ctrl.appendChild(stopBtn);
        const shuffleBtn = document.createElement('button');
        shuffleBtn.textContent = shuffleEnabled ? 'Shuffle: ON' : 'Shuffle: OFF';
        shuffleBtn.className = 'btn-shuffle'; shuffleBtn.onclick = toggleShuffle;
        ctrl.appendChild(shuffleBtn);
      }
      if (stage === 'results') {
        const retryBtn = document.createElement('button');
        retryBtn.textContent = 'Retry Wrong Words'; retryBtn.className = 'btn-retry'; retryBtn.onclick = retryWrong;
        ctrl.appendChild(retryBtn);
        const restartBtn = document.createElement('button');
        restartBtn.textContent = 'Restart Full Quiz'; restartBtn.className = 'btn-restart'; restartBtn.onclick = restart;
        ctrl.appendChild(restartBtn);
      }
      const score = document.createElement('span');
      score.id = 'scoreboard'; score.textContent = `ë§ìŒ: ${correctCount}, í‹€ë¦¼: ${wrongCount}`;
      ctrl.appendChild(score);
    }

    function renderChecklist() {
      const cl = document.getElementById('checklist');
      cl.innerHTML = '';
      if (stage === 'quiz') {
        const div = document.createElement('div'); div.className = 'item';
        if (history.length > 0) {
          const item = history[history.length - 1];
          div.innerHTML = item.isCorrect
            ? `${item.korean}: âœ… ${item.english}`
            : `${item.korean}: âŒ ì •ë‹µ: ${item.english}<br>(ë‚´ ë‹µ: ${item.userAnswer})`;
        }
        cl.appendChild(div);
      }
    }

    function render() {
      renderControls(); renderChecklist();
      const app = document.getElementById('app'); app.innerHTML = '';
      if (stage === 'initial') {
        app.innerHTML = `<table><thead><tr><th>í•œêµ­ì–´</th><th>English</th></tr></thead>` +
                        `<tbody>${originalList.map(i => `<tr><td>${i.korean}</td><td>${i.english}</td></tr>`).join('')}</tbody></table>`;
      }
      // render() ë‚´ë¶€, stage==='quiz' ë¸”ë¡ì„ ì´ê±¸ë¡œ ëŒ€ì²´
if (stage === 'quiz') {
  const idx = history.length;
  const curr = quizList[idx];
  app.innerHTML = `
    <div><strong>Q${idx+1}.</strong> ${curr.korean}</div>
    <input type="text" id="answer" />
    <button class="btn-submit">Submit</button>
  `;
  const input = document.getElementById('answer');
  // í•­ìƒ í¬ì»¤ìŠ¤ ìœ ì§€
  input.focus();
  // ê¸°ì¡´ ì…ë ¥ê°’ ìˆì„ ë•Œ ë“œë˜ê·¸ ì„ íƒ(optional)
  input.select();

  const btn = app.querySelector('button');
  btn.onclick = submitAnswer;

  input.onkeydown = e => {
    if (e.key === 'Enter') {
      e.preventDefault();
      submitAnswer();
      // ì œì¶œ ë’¤ì—ë„ í¬ì»¤ìŠ¤ ìœ ì§€
      const nextInput = document.getElementById('answer');
      if (nextInput) nextInput.focus();
    }
  };
}

      if (stage === 'results') {
        let html = '<h2>Quiz Finished!</h2>';
        html += wrongCount > 0
          ? `<p>You got ${wrongCount} wrong:</p><table><thead><tr><th>í•œêµ­ì–´</th><th>English</th></tr></thead>` +
            `<tbody>${history.filter(h => !h.isCorrect).map(h => `<tr><td>${h.korean}</td><td>${h.english}</td></tr>`).join('')}</tbody></table>`
          : '<p>Perfect score! ğŸ‰</p>';
        app.innerHTML = html;
      }
    }

    function submitAnswer() {
      const input = document.getElementById('answer'); const val = input.value.trim();
      const curr = quizList[history.length];
      const isCorrect = normalize(val) === normalize(curr.english);
      history.push({ korean: curr.korean, english: curr.english, isCorrect, userAnswer: val });
      isCorrect ? correctCount++ : wrongCount++;
      input.value = '';
      if (history.length < quizList.length) render(); else { stage = 'results'; render(); }
    }

    function retryWrong() {
      baseList = history.filter(h => !h.isCorrect).map(h => ({ korean: h.korean, english: h.english }));
      history = [];
      correctCount = 0; wrongCount = 0;
      stage = 'quiz';
      shuffleEnabled = false;
      rebuildQuizList();
      render();
    }

    function restart() {
      baseList = [...originalList];
      quizList = [...baseList];
      history = [];
      correctCount = 0; wrongCount = 0;
      shuffleEnabled = false;
      stage = 'initial';
      render();
    }

    document.addEventListener('DOMContentLoaded', render);
  </script>
  <p>ì´ì œ íŠ¹ìˆ˜ê¸°í˜¸ê°™ì€ ê±° ë‹¤ ë¬´ì‹œí•˜ê³  ì˜ì–´ ì•ŒíŒŒë²³ë§Œ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•˜ë©´ ì •ë‹µì´ ë©ë‹ˆë‹¤. ìŠ¤í˜ì´ìŠ¤ë°” ëŒ€ì†Œë¬¸ìë„ ë‹¤ ë´ì¤˜ìš”</p>
</body>
</html>
